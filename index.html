<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sentinel-X | Guess The Flag</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: "Trebuchet MS","Segoe UI",sans-serif;
}

body {
  min-height: 100vh;
  background: url("images/background.png") no-repeat center center fixed;
  background-size: cover;
}

.overlay {
  min-height: 100vh;
  background: linear-gradient(rgba(20,140,255,.75), rgba(10,80,180,.85));
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
}

.game-box {
  width: 100%;
  max-width: 560px;
  background: rgba(255,255,255,.18);
  backdrop-filter: blur(12px);
  border-radius: 28px;
  padding: 22px;
  color: white;
  box-shadow: 0 25px 60px rgba(0,0,0,.35);
  text-align: center;
}

.logo {
  width: 110px;
  margin-bottom: 8px;
}

/* START SCREEN */
.start-screen label {
  display: block;
  margin-bottom: 14px;
  font-size: .9rem;
}

.start-screen input {
  width: 100%;
}

.start-btn {
  margin-top: 14px;
  border: none;
  border-radius: 999px;
  padding: 14px;
  font-weight: 700;
  font-size: 1rem;
  cursor: pointer;
  background: linear-gradient(135deg,#ffd54f,#ffb300);
  color: #4a2c00;
}

/* GAME */
.score {
  font-size: .9rem;
  margin-bottom: 6px;
}

.flag-box {
  display: flex;
  justify-content: center;
  margin: 8px 0;
}

.flag-box img {
  width: 120px;
  height: 90px;
  background: white;
  border-radius: 10px;
  padding: 6px;
}

.question {
  margin: 12px 0;
  font-size: 1.05rem;
}

.answers {
  display: grid;
  gap: 10px;
}

.answer-btn {
  border: none;
  border-radius: 999px;
  padding: 12px;
  font-weight: 600;
  background: rgba(255,255,255,.3);
  color: white;
  cursor: pointer;
  position: relative;
}

.answer-btn.correct { background: #4caf50; }
.answer-btn.wrong { background: #e53935; }

.answer-btn.correct::after {
  content: " ✔";
  position: absolute;
  right: 16px;
}

.answer-btn.wrong::after {
  content: " ✖";
  position: absolute;
  right: 16px;
}

/* END SCREEN */
.end-screen {
  display: none;
}
</style>
</head>

<body>
<div class="overlay">
<div class="game-box">

<img src="logo/logo.png" class="logo" alt="Sentinel-X">

<!-- START -->
<div id="startScreen" class="start-screen">
  <label>
    Game Duration (seconds):
    <strong><span id="durVal">60</span></strong>
    <input type="range" min="10" max="120" value="60" id="duration">
  </label>

  <label>
    Question Speed (seconds per question):
    <strong><span id="spdVal">5</span></strong>
    <input type="range" min="3" max="10" value="5" id="speed">
  </label>

  <button class="start-btn" onclick="startGame()">▶ Start Game</button>
</div>

<!-- GAME -->
<div id="gameScreen" style="display:none;">
  <div class="score">
    Score: <span id="score">0</span> |
    Time Left: <span id="timeLeft">0</span>s
  </div>

  <div class="flag-box">
    <img id="flagImage"
         loading="lazy"
         decoding="async"
         alt="Country flag">
  </div>

  <div id="question" class="question"></div>
  <div id="answers" class="answers"></div>
</div>

<!-- END -->
<div id="endScreen" class="end-screen">
  <h2>Game Over</h2>
  <p>Your Score: <strong id="finalScore">0</strong></p>
  <br>
  <button class="start-btn" onclick="location.reload()">Replay</button>
  <br><br>
  <button class="start-btn"
    onclick="window.location.href='https://sentinelxzimbabwe.github.io/Guess-The-Flag-Game/'">
    Return Home
  </button>
</div>

</div>
</div>

<script>
/* =============================
   COUNTRY DATA (~200)
============================= */

const COUNTRIES = [
  {iso:"us",country:"United States",capital:"Washington, D.C."},
  {iso:"gb",country:"United Kingdom",capital:"London"},
  {iso:"fr",country:"France",capital:"Paris"},
  {iso:"de",country:"Germany",capital:"Berlin"},
  {iso:"it",country:"Italy",capital:"Rome"},
  {iso:"es",country:"Spain",capital:"Madrid"},
  {iso:"ua",country:"Ukraine",capital:"Kyiv"},
  {iso:"pl",country:"Poland",capital:"Warsaw"},
  {iso:"cn",country:"China",capital:"Beijing"},
  {iso:"jp",country:"Japan",capital:"Tokyo"},
  {iso:"in",country:"India",capital:"New Delhi"},
  {iso:"br",country:"Brazil",capital:"Brasília"},
  {iso:"za",country:"South Africa",capital:"Pretoria"},
  {iso:"ng",country:"Nigeria",capital:"Abuja"},
  {iso:"zw",country:"Zimbabwe",capital:"Harare"}
  // (dataset trimmed here for brevity – keep your full ~200 list)
];

/* =============================
   PERFORMANCE OPTIMIZATIONS
============================= */

const flagImage = document.getElementById("flagImage");
const preloadImg = new Image();

/* =============================
   GAME ENGINE
============================= */

let score = 0;
let timeLeft = 0;
let qSpeed = 5;
let gameTimer, questionTimer;
let locked = false;

duration.oninput = e => durVal.textContent = e.target.value;
speed.oninput = e => spdVal.textContent = e.target.value;

function rand(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

function startGame() {
  score = 0;
  timeLeft = +duration.value;
  qSpeed = +speed.value;

  startScreen.style.display = "none";
  gameScreen.style.display = "block";

  scoreSpan.textContent = score;
  timeLeftSpan.textContent = timeLeft;

  gameTimer = setInterval(() => {
    timeLeft--;
    timeLeftSpan.textContent = timeLeft;
    if (timeLeft <= 0) endGame();
  }, 1000);

  nextQuestion();
}

function endGame() {
  clearInterval(gameTimer);
  clearTimeout(questionTimer);
  gameScreen.style.display = "none";
  endScreen.style.display = "block";
  finalScore.textContent = score;
}

function nextQuestion() {
  locked = false;
  clearTimeout(questionTimer);
  answers.innerHTML = "";

  const c = rand(COUNTRIES);
  const next = rand(COUNTRIES); // preload next flag
  preloadImg.src = `https://flagcdn.com/120x90/${next.iso}.png`;

  const mode = rand(["flag","country","capital"]);
  let correct;

  if (mode === "flag") {
    flagImage.src = `https://flagcdn.com/120x90/${c.iso}.png`;
    question.textContent = "Which country is this flag?";
    correct = c.country;
    buildText(correct, "country");
  }

  if (mode === "country") {
    flagImage.src = "";
    question.textContent = `Select the flag of ${c.country}`;
    correct = c.iso;
    buildFlags(correct);
  }

  if (mode === "capital") {
    flagImage.src = "";
    question.textContent = `What is the capital of ${c.country}?`;
    correct = c.capital;
    buildText(correct, "capital");
  }

  questionTimer = setTimeout(() => {
    if (!locked) nextQuestion();
  }, qSpeed * 1000);
}

function buildText(correct, field) {
  const opts = [correct];
  while (opts.length < 4) {
    const v = rand(COUNTRIES)[field];
    if (!opts.includes(v)) opts.push(v);
  }
  opts.sort(() => Math.random() - .5);

  opts.forEach(v => {
    const b = document.createElement("button");
    b.className = "answer-btn";
    b.textContent = v;
    b.onclick = () => select(b, v === correct, correct);
    answers.appendChild(b);
  });
}

function buildFlags(correctIso) {
  const opts = [correctIso];
  while (opts.length < 4) {
    const v = rand(COUNTRIES).iso;
    if (!opts.includes(v)) opts.push(v);
  }
  opts.sort(() => Math.random() - .5);

  opts.forEach(i => {
    const b = document.createElement("button");
    b.className = "answer-btn";
    b.innerHTML = `<img src="https://flagcdn.com/120x90/${i}.png" width="60" height="45">`;
    b.onclick = () => select(b, i === correctIso, correctIso);
    answers.appendChild(b);
  });
}

function select(btn, isCorrect, correctVal) {
  if (locked) return;
  locked = true;
  clearTimeout(questionTimer);

  document.querySelectorAll(".answer-btn").forEach(b => {
    if (
      b.textContent === correctVal ||
      b.innerHTML.includes(`/${correctVal}.png`)
    ) {
      b.classList.add("correct");
    }
    b.disabled = true;
  });

  if (isCorrect) {
    score += 5;
    scoreSpan.textContent = score;
  } else {
    btn.classList.add("wrong");
  }

  setTimeout(nextQuestion, 2000);
}

/* DOM SHORTCUTS */
const scoreSpan = document.getElementById("score");
const timeLeftSpan = document.getElementById("timeLeft");
</script>
</body>
</html>
